<!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Boeing 737 MAX Coordinate Viewer</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
                overflow: hidden;
            }
            
            #container {
                display: flex;
                height: 100vh;
            }
            
            #sidebar {
                width: 350px;
                background: rgba(255, 255, 255, 0.95);
                padding: 20px;
                overflow-y: auto;
                box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            }
            
            #viewer {
                flex: 1;
                position: relative;
            }
            
            h1 {
                color: #1e3c72;
                margin-bottom: 20px;
                font-size: 24px;
                border-bottom: 3px solid #2a5298;
                padding-bottom: 10px;
            }
            
            .input-group {
                margin-bottom: 20px;
            }
            
            label {
                display: block;
                margin-bottom: 5px;
                color: #333;
                font-weight: 600;
            }
            
            input[type="number"], select {
                width: 100%;
                padding: 10px;
                border: 2px solid #ddd;
                border-radius: 5px;
                font-size: 16px;
                transition: border-color 0.3s;
            }
            
            input[type="number"]:focus, select:focus {
                outline: none;
                border-color: #2a5298;
            }
            
            .bl-container {
                display: flex;
                gap: 10px;
            }
            
            .bl-container input {
                flex: 2;
            }
            
            .bl-container select {
                flex: 1;
            }
            
            button {
                width: 100%;
                padding: 12px;
                background: #2a5298;
                color: white;
                border: none;
                border-radius: 5px;
                font-size: 16px;
                font-weight: 600;
                cursor: pointer;
                transition: background 0.3s;
                margin-bottom: 10px;
            }
            
            button:hover {
                background: #1e3c72;
            }
            
            .reference {
                margin-top: 20px;
                padding: 15px;
                background: #f0f8ff;
                border-radius: 5px;
                border-left: 4px solid #2a5298;
            }
            
            .reference h3 {
                color: #1e3c72;
                margin-bottom: 10px;
                font-size: 16px;
            }
            
            .reference p {
                margin: 5px 0;
                font-size: 13px;
                color: #555;
            }
            
            #controls {
                margin-top: 20px;
                padding-top: 20px;
                border-top: 2px solid #ddd;
            }
            
            .slider-group {
                margin-bottom: 15px;
            }
            
            input[type="range"] {
                width: 100%;
            }
            
            .slider-value {
                text-align: center;
                color: #2a5298;
                font-weight: 600;
                margin-top: 5px;
            }
            
            #coordinates-info {
                position: absolute;
                top: 20px;
                right: 20px;
                background: rgba(255, 255, 255, 0.95);
                padding: 15px;
                border-radius: 8px;
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                min-width: 250px;
                display: none;
            }
            
            #coordinates-info h3 {
                color: #1e3c72;
                margin-bottom: 10px;
                font-size: 16px;
            }
            
            #coordinates-info p {
                margin: 5px 0;
                font-size: 14px;
                color: #333;
            }
            
            .coord-value {
                color: #2a5298;
                font-weight: 600;
            }
        </style>
    </head>
    <body>
        <div id="container">
            <div id="sidebar">
                <h1>Boeing 737 MAX<br>Coordinate Viewer</h1>
                
                <div class="input-group">
                    <label for="station">Station (STA)</label>
                    <input type="number" id="station" placeholder="e.g., 700" step="0.1">
                </div>
                
                <div class="input-group">
                    <label for="waterline">Waterline (WL)</label>
                    <input type="number" id="waterline" placeholder="e.g., 200" step="0.1">
                </div>
                
                <div class="input-group">
                    <label for="buttock">Buttock Line (BL)</label>
                    <div class="bl-container">
                        <input type="number" id="buttock" placeholder="e.g., 33" step="0.1">
                        <select id="bl-side">
                            <option value="R">RBL</option>
                            <option value="L">LBL</option>
                        </select>
                    </div>
                </div>
                
                <button onclick="plotCoordinate()">Plot Coordinate</button>
                <button onclick="clearMarker()">Clear Marker</button>
                
                <div id="controls">
                    <h3 style="color: #1e3c72; margin-bottom: 15px;">Display Controls</h3>
                    
                    <button onclick="toggleTransparency()">Toggle Transparency</button>
                    <button onclick="toggleWireframe()">Toggle Wireframe</button>
                    
                    <div class="slider-group">
                        <label>Fuselage Opacity</label>
                        <input type="range" id="opacity" min="0" max="100" value="30" oninput="updateOpacity(this.value)">
                        <div class="slider-value"><span id="opacity-value">30</span>%</div>
                    </div>
                </div>
                
                <div class="reference">
                    <h3>Key Reference Points</h3>
                    <p><strong>STA 130:</strong> Nose tip</p>
                    <p><strong>STA 291.5:</strong> Forward entry door</p>
                    <p><strong>STA 323.7-351.2:</strong> Electronics bay</p>
                    <p><strong>STA 492.4:</strong> Forward cargo door (Section 43)</p>
                    <p><strong>STA 700:</strong> Wing center (Section 44)</p>
                    <p><strong>STA 794.3:</strong> Aft cargo door (Section 46)</p>
                    <p><strong>STA 1217:</strong> Tail end (737-8)</p>
                    <p><strong>STA 1295:</strong> Tail end (737-9)</p>
                    <p><br><strong>WL 100:</strong> Floor level (approx)</p>
                    <p><strong>WL 207.54:</strong> Crew cabin floor</p>
                    <p><strong>WL 246.1:</strong> Windows level</p>
                    <p><strong>BL 0:</strong> Centerline</p>
                    <p><strong>BL 33:</strong> Right/Left fuselage edge</p>
                    <p><strong>BL 64:</strong> Outer stringers</p>
                </div>
            </div>
            
            <div id="viewer"></div>
            
            <div id="coordinates-info">
                <h3>Hover Coordinates</h3>
                <p>STA: <span class="coord-value" id="hover-sta">-</span></p>
                <p>WL: <span class="coord-value" id="hover-wl">-</span></p>
                <p>BL: <span class="coord-value" id="hover-bl">-</span></p>
            </div>
        </div>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
        
        <script>
            let scene, camera, renderer, controls;
            let fuselage, marker;
            let raycaster, mouse;
            
            // Boeing 737 MAX dimensions and coordinates
            const AIRCRAFT = {
                minStation: 130,      // Nose tip
                maxStation: 1217,     // Tail (737-8)
                fuselageLength: 39.5, // meters (737-8)
                fuselageRadius: 1.88, // meters
                
                // Key sections
                sections: {
                    41: { start: 130, end: 390 },
                    43: { start: 390, end: 578 },
                    44: { start: 578, end: 727 },
                    46: { start: 727, end: 847 },
                    47: { start: 847, end: 1016 },
                    48: { start: 1016, end: 1217 }
                }
            };
            
            function init() {
                // Scene setup
                scene = new THREE.Scene();
                scene.background = new THREE.Color(0x87ceeb);
                
                // Camera
                camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                camera.position.set(30, 10, 30);
                
                // Renderer
                renderer = new THREE.WebGLRenderer({ antialias: true });
                renderer.setSize(document.getElementById('viewer').clientWidth, window.innerHeight);
                document.getElementById('viewer').appendChild(renderer.domElement);
                
                // Controls
                controls = new THREE.OrbitControls(camera, renderer.domElement);
                controls.enableDamping = true;
                
                // Raycaster for mouse picking
                raycaster = new THREE.Raycaster();
                mouse = new THREE.Vector2();
                
                // Lighting
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
                scene.add(ambientLight);
                
                const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
                directionalLight.position.set(10, 10, 10);
                scene.add(directionalLight);
                
                // Grid
                const gridHelper = new THREE.GridHelper(50, 50, 0x444444, 0x888888);
                scene.add(gridHelper);
                
                // Axes
                const axesHelper = new THREE.AxesHelper(20);
                scene.add(axesHelper);
                
                // Create aircraft
                createAircraft();
                
                // Mouse move listener
                renderer.domElement.addEventListener('mousemove', onMouseMove);
                
                // Window resize
                window.addEventListener('resize', onWindowResize);
                
                animate();
            }
            
            function createAircraft() {
                const aircraftGroup = new THREE.Group();
                
                // Fuselage - Create as multiple segments for better shape
                const fuselageGroup = new THREE.Group();
                const segments = 50;
                const length = AIRCRAFT.fuselageLength;
                
                // Main cylindrical fuselage
                const fuselageGeometry = new THREE.CylinderGeometry(
                    AIRCRAFT.fuselageRadius, 
                    AIRCRAFT.fuselageRadius, 
                    length * 0.7, 
                    32
                );
                const fuselageMaterial = new THREE.MeshPhongMaterial({
                    color: 0xcccccc,
                    transparent: true,
                    opacity: 0.3,
                    side: THREE.DoubleSide
                });
                fuselage = new THREE.Mesh(fuselageGeometry, fuselageMaterial);
                fuselage.rotation.z = Math.PI / 2;
                fuselage.position.x = length * 0.15; // Center the main fuselage section
                fuselageGroup.add(fuselage);
                
                // Nose cone (pointing forward/outward)
                const noseGeometry = new THREE.ConeGeometry(AIRCRAFT.fuselageRadius, length * 0.25, 32);
                const nose = new THREE.Mesh(noseGeometry, fuselageMaterial);
                nose.rotation.z = -Math.PI / 2; // Point nose forward (negative X direction)
                nose.position.x = -length * 0.225; // Position at front
                fuselageGroup.add(nose);
                
                // Tail cone
                const tailGeometry = new THREE.ConeGeometry(AIRCRAFT.fuselageRadius * 0.3, length * 0.3, 32);
                const tail = new THREE.Mesh(tailGeometry, fuselageMaterial);
                tail.rotation.z = Math.PI / 2; // Point tail backward
                tail.position.x = length * 0.55;
                fuselageGroup.add(tail);
                
                aircraftGroup.add(fuselageGroup);
                
                // Wings (horizontal, extending from sides)
                const wingGeometry = new THREE.BoxGeometry(1, 17, 4); // width, span, chord
                const wingMaterial = new THREE.MeshPhongMaterial({ color: 0x4a90e2 });
                const wings = new THREE.Mesh(wingGeometry, wingMaterial);
                wings.position.set(staToX(700), 0, 0); // Position at wing station
                aircraftGroup.add(wings);
                
                // Horizontal stabilizer (smaller horizontal tail)
                const hStabGeometry = new THREE.BoxGeometry(0.5, 7, 2);
                const hStab = new THREE.Mesh(hStabGeometry, wingMaterial);
                hStab.position.set(staToX(1050), 0, 0);
                aircraftGroup.add(hStab);
                
                // Vertical stabilizer (tail fin pointing up)
                const vStabGeometry = new THREE.BoxGeometry(0.5, 2, 5);
                const vStab = new THREE.Mesh(vStabGeometry, wingMaterial);
                vStab.position.set(staToX(1050), 0, 4);
                aircraftGroup.add(vStab);
                
                // Forward Entry Door (STA 291.5) - Orange marker
                const doorGeometry = new THREE.BoxGeometry(0.3, 1, 1.5);
                const doorMaterial = new THREE.MeshPhongMaterial({ color: 0xff6600 });
                const entryDoor = new THREE.Mesh(doorGeometry, doorMaterial);
                entryDoor.position.set(staToX(291.5), 0, AIRCRAFT.fuselageRadius + 0.2);
                aircraftGroup.add(entryDoor);
                
                // Door label
                const doorLabel = createTextSprite('Entry Door
STA 291.5');
                doorLabel.position.set(staToX(291.5), 0, AIRCRAFT.fuselageRadius + 2);
                aircraftGroup.add(doorLabel);
                
                // Electronics & Equipment Compartment (STA 323.7 - 351.2) - Blue wireframe box
                const elecLength = staToX(351.2) - staToX(323.7);
                const elecGeometry = new THREE.BoxGeometry(elecLength, 2, 1);
                const elecMaterial = new THREE.MeshBasicMaterial({ 
                    color: 0x0099ff, 
                    wireframe: true,
                    opacity: 0.7,
                    transparent: true
                });
                const elecBay = new THREE.Mesh(elecGeometry, elecMaterial);
                elecBay.position.set((staToX(323.7) + staToX(351.2)) / 2, 0, -AIRCRAFT.fuselageRadius - 0.5);
                aircraftGroup.add(elecBay);
                
                // Electronics bay label
                const elecLabel = createTextSprite('Electronics
STA 323.7-351.2');
                elecLabel.position.set((staToX(323.7) + staToX(351.2)) / 2, 0, -AIRCRAFT.fuselageRadius - 2);
                aircraftGroup.add(elecLabel);
                
                scene.add(aircraftGroup);
            }
            
            function createTextSprite(text) {
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                canvas.width = 256;
                canvas.height = 128;
                
                context.fillStyle = 'rgba(255, 255, 255, 0.9)';
                context.fillRect(0, 0, canvas.width, canvas.height);
                
                context.font = 'Bold 20px Arial';
                context.fillStyle = 'black';
                context.textAlign = 'center';
                
                const lines = text.split('
');
                lines.forEach((line, i) => {
                    context.fillText(line, canvas.width / 2, 40 + i * 30);
                });
                
                const texture = new THREE.CanvasTexture(canvas);
                const spriteMaterial = new THREE.SpriteMaterial({ map: texture });
                const sprite = new THREE.Sprite(spriteMaterial);
                sprite.scale.set(4, 2, 1);
                
                return sprite;
            }
            
            function staToX(station) {
                // Convert station number to X coordinate
                const ratio = (station - AIRCRAFT.minStation) / (AIRCRAFT.maxStation - AIRCRAFT.minStation);
                return (ratio - 0.5) * AIRCRAFT.fuselageLength;
            }
            
            function xToSta(x) {
                // Convert X coordinate back to station number
                const ratio = (x / AIRCRAFT.fuselageLength) + 0.5;
                return AIRCRAFT.minStation + ratio * (AIRCRAFT.maxStation - AIRCRAFT.minStation);
            }
            
            function wlToY(waterline) {
                // Waterline typically ranges from ~100 to ~350
                // Map to Y coordinate (0 is roughly WL 180)
                return (waterline - 180) / 50;
            }
            
            function yToWl(y) {
                return 180 + (y * 50);
            }
            
            function blToZ(buttock, side) {
                // Buttock line - 0 is centerline, positive is distance from center
                // Side: 'R' for right (positive Z), 'L' for left (negative Z)
                const z = buttock / 20;
                return side === 'L' ? -z : z;
            }
            
            function zToBl(z) {
                return Math.abs(z) * 20;
            }
            
            function plotCoordinate() {
                const sta = parseFloat(document.getElementById('station').value);
                const wl = parseFloat(document.getElementById('waterline').value);
                const bl = parseFloat(document.getElementById('buttock').value);
                const side = document.getElementById('bl-side').value;
                
                if (isNaN(sta) || isNaN(wl) || isNaN(bl)) {
                    alert('Please enter valid coordinates');
                    return;
                }
                
                // Remove existing marker
                if (marker) {
                    scene.remove(marker);
                }
                
                // Create marker
                const markerGeometry = new THREE.SphereGeometry(0.3, 32, 32);
                const markerMaterial = new THREE.MeshPhongMaterial({ 
                    color: 0xff0000,
                    emissive: 0xff0000,
                    emissiveIntensity: 0.5
                });
                marker = new THREE.Mesh(markerGeometry, markerMaterial);
                
                marker.position.set(
                    staToX(sta),
                    wlToY(wl),
                    blToZ(bl, side)
                );
                
                scene.add(marker);
                
                // Animate marker (pulsing effect)
                let scale = 1;
                let growing = true;
                
                function animateMarker() {
                    if (!marker) return;
                    
                    if (growing) {
                        scale += 0.02;
                        if (scale >= 1.3) growing = false;
                    } else {
                        scale -= 0.02;
                        if (scale <= 1) growing = true;
                    }
                    
                    marker.scale.set(scale, scale, scale);
                    requestAnimationFrame(animateMarker);
                }
                
                animateMarker();
                
                // Determine section
                let section = 'Unknown';
                for (const [sec, range] of Object.entries(AIRCRAFT.sections)) {
                    if (sta >= range.start && sta <= range.end) {
                        section = sec;
                        break;
                    }
                }
                
                console.log(`Plotted: STA ${sta}, WL ${wl}, ${side}BL ${bl} (Section ${section})`);
            }
            
            function clearMarker() {
                if (marker) {
                    scene.remove(marker);
                    marker = null;
                }
            }
            
            function toggleTransparency() {
                if (fuselage.material.opacity === 0.3) {
                    fuselage.material.opacity = 1.0;
                    document.getElementById('opacity').value = 100;
                    document.getElementById('opacity-value').textContent = 100;
                } else {
                    fuselage.material.opacity = 0.3;
                    document.getElementById('opacity').value = 30;
                    document.getElementById('opacity-value').textContent = 30;
                }
            }
            
            function toggleWireframe() {
                fuselage.material.wireframe = !fuselage.material.wireframe;
            }
            
            function updateOpacity(value) {
                fuselage.material.opacity = value / 100;
                document.getElementById('opacity-value').textContent = value;
            }
            
            function onMouseMove(event) {
                const rect = renderer.domElement.getBoundingClientRect();
                mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
                mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
                
                raycaster.setFromCamera(mouse, camera);
                const intersects = raycaster.intersectObjects(scene.children, true);
                
                if (intersects.length > 0) {
                    const point = intersects[0].point;
                    const sta = xToSta(point.x).toFixed(1);
                    const wl = yToWl(point.y).toFixed(1);
                    const bl = zToBl(point.z).toFixed(1);
                    const side = point.z >= 0 ? 'R' : 'L';
                    
                    document.getElementById('hover-sta').textContent = sta;
                    document.getElementById('hover-wl').textContent = wl;
                    document.getElementById('hover-bl').textContent = `${side}BL ${bl}`;
                    document.getElementById('coordinates-info').style.display = 'block';
                } else {
                    document.getElementById('coordinates-info').style.display = 'none';
                }
            }
            
            function onWindowResize() {
                camera.aspect = document.getElementById('viewer').clientWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(document.getElementById('viewer').clientWidth, window.innerHeight);
            }
            
            function animate() {
                requestAnimationFrame(animate);
                controls.update();
                renderer.render(scene, camera);
            }
            
            init();
        </script>
    </body>
    </html>