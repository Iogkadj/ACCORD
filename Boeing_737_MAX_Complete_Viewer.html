<!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Boeing 737 MAX Coordinate Viewer</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                padding: 20px;
            }
            .container {
                max-width: 1600px;
                margin: 0 auto;
                background: white;
                border-radius: 15px;
                box-shadow: 0 20px 60px rgba(0,0,0,0.3);
                overflow: hidden;
            }
            .header {
                background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
                color: white;
                padding: 30px;
                text-align: center;
            }
            .header h1 {
                font-size: 32px;
                margin-bottom: 10px;
            }
            .header p {
                font-size: 16px;
                opacity: 0.9;
            }
            .main-content {
                display: grid;
                grid-template-columns: 350px 1fr;
                gap: 0;
            }
            .sidebar {
                background: #f8f9fa;
                padding: 30px;
                border-right: 2px solid #dee2e6;
            }
            .input-group {
                margin-bottom: 25px;
            }
            .input-group label {
                display: block;
                font-weight: 600;
                color: #2c3e50;
                margin-bottom: 8px;
                font-size: 14px;
            }
            .input-row {
                display: flex;
                gap: 10px;
                align-items: center;
            }
            .input-group input, .input-group select {
                width: 100%;
                padding: 12px;
                border: 2px solid #ddd;
                border-radius: 8px;
                font-size: 16px;
                transition: border-color 0.3s;
            }
            .input-group input:focus, .input-group select:focus {
                outline: none;
                border-color: #667eea;
            }
            .input-group select {
                flex: 0 0 80px;
            }
            .input-group input[type="number"] {
                flex: 1;
            }
            .btn {
                width: 100%;
                padding: 15px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                border: none;
                border-radius: 8px;
                font-size: 16px;
                font-weight: 600;
                cursor: pointer;
                transition: transform 0.2s, box-shadow 0.2s;
            }
            .btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
            }
            .btn:active {
                transform: translateY(0);
            }
            .info-box {
                background: #e3f2fd;
                border-left: 4px solid #2196f3;
                padding: 15px;
                margin-top: 20px;
                border-radius: 5px;
                font-size: 13px;
                line-height: 1.6;
            }
            .info-box h3 {
                color: #1976d2;
                margin-bottom: 10px;
                font-size: 14px;
            }
            .info-box ul {
                margin-left: 20px;
            }
            .info-box li {
                margin-bottom: 5px;
            }
            .viewer-container {
                position: relative;
                background: #000;
            }
            #viewer3d {
                width: 100%;
                height: 800px;
                display: block;
            }
            .controls {
                position: absolute;
                top: 20px;
                right: 20px;
                background: rgba(255, 255, 255, 0.95);
                padding: 15px;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                z-index: 10;
            }
            .controls button {
                display: block;
                width: 100%;
                padding: 8px 15px;
                margin-bottom: 8px;
                background: #2196f3;
                color: white;
                border: none;
                border-radius: 5px;
                cursor: pointer;
                font-size: 13px;
            }
            .controls button:hover {
                background: #1976d2;
            }
            .controls button:last-child {
                margin-bottom: 0;
            }
            .coord-display {
                position: absolute;
                top: 20px;
                left: 20px;
                background: rgba(0, 0, 0, 0.85);
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                font-family: 'Courier New', monospace;
                font-size: 14px;
                display: none;
                z-index: 10;
                box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            }
            .coord-display.active {
                display: block;
            }
            .coord-display div {
                margin-bottom: 5px;
            }
            .coord-display div:last-child {
                margin-bottom: 0;
            }
            .coord-label {
                color: #4fc3f7;
                font-weight: bold;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1>‚úàÔ∏è Boeing 737 MAX Coordinate Viewer</h1>
                <p>Visualize Station (STA), Waterline (WL), and Buttock Line (BL) coordinates in 3D</p>
            </div>
            
            <div class="main-content">
                <div class="sidebar">
                    <div class="input-group">
                        <label for="station">Station (STA)</label>
                        <input type="number" id="station" placeholder="130 - 1217" step="0.1" value="700">
                    </div>
                    
                    <div class="input-group">
                        <label for="waterline">Waterline (WL)</label>
                        <input type="number" id="waterline" placeholder="e.g., 208.54" step="0.1" value="208">
                    </div>
                    
                    <div class="input-group">
                        <label for="buttockline">Buttock Line (BL)</label>
                        <div class="input-row">
                            <select id="blSide">
                                <option value="R">RBL</option>
                                <option value="L">LBL</option>
                            </select>
                            <input type="number" id="buttockline" placeholder="0 - 64" step="0.1" value="0">
                        </div>
                    </div>
                    
                    <button class="btn" onclick="plotCoordinate()">üìç Plot Coordinate</button>
                    
                    <div class="info-box">
                        <h3>‚ÑπÔ∏è Coordinate System</h3>
                        <ul>
                            <li><strong>STA 130:</strong> Nose</li>
                            <li><strong>STA 291.5:</strong> Fwd Entry Door</li>
                            <li><strong>STA 323.7-351.2:</strong> Electronics Bay</li>
                            <li><strong>STA 700:</strong> Wing Center (Sec 44)</li>
                            <li><strong>STA 1217:</strong> Tail</li>
                            <li><strong>WL 0:</strong> Bottom reference</li>
                            <li><strong>BL 0:</strong> Centerline</li>
                            <li><strong>RBL:</strong> Right Buttock Line</li>
                            <li><strong>LBL:</strong> Left Buttock Line</li>
                        </ul>
                    </div>
                    
                    <div class="info-box" style="background: #fff3cd; border-left-color: #ffc107; margin-top: 15px;">
                        <h3 style="color: #856404;">üñ±Ô∏è Interactive Features</h3>
                        <p><strong>Click</strong> on the aircraft to get coordinates at that location!</p>
                    </div>
                </div>
                
                <div class="viewer-container">
                    <canvas id="viewer3d"></canvas>
                    
                    <div class="controls">
                        <button onclick="toggleTransparency()">Toggle Transparency</button>
                        <button onclick="toggleWireframe()">Toggle Wireframe</button>
                        <button onclick="resetCamera()">Reset View</button>
                    </div>
                    
                    <div class="coord-display" id="coordDisplay">
                        <div><span class="coord-label">STA:</span> <span id="hoverSta">--</span></div>
                        <div><span class="coord-label">WL:</span> <span id="hoverWl">--</span></div>
                        <div><span class="coord-label">BL:</span> <span id="hoverBl">--</span></div>
                        <div style="margin-top: 10px; color: #4fc3f7; font-size: 12px;">Click to plot this point</div>
                    </div>
                </div>
            </div>
        </div>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
        <script>
            let scene, camera, renderer, controls;
            let fuselage, wings, tail, marker;
            let isTransparent = true;
            let isWireframe = false;
            let raycaster, mouse;
            let interactiveObjects = [];
    
            // Boeing 737 MAX dimensions and coordinates
            const AIRCRAFT = {
                staMin: 130,      // Nose
                staMax: 1217,     // Tail (737-8)
                length: 39.52,    // meters
                diameter: 3.76,   // meters (fuselage)
                wingspan: 35.9    // meters
            };
    
            function init() {
                // Scene
                scene = new THREE.Scene();
                scene.background = new THREE.Color(0x000000);
    
                // Camera
                const canvas = document.getElementById('viewer3d');
                camera = new THREE.PerspectiveCamera(
                    45,
                    canvas.clientWidth / canvas.clientHeight,
                    0.1,
                    1000
                );
                camera.position.set(50, 30, 50);
                camera.lookAt(0, 0, 0);
    
                // Renderer
                renderer = new THREE.WebGLRenderer({
                    canvas: canvas,
                    antialias: true
                });
                renderer.setSize(canvas.clientWidth, canvas.clientHeight);
    
                // Raycaster for mouse interaction
                raycaster = new THREE.Raycaster();
                mouse = new THREE.Vector2();
    
                // Lights
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
                scene.add(ambientLight);
    
                const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
                directionalLight.position.set(10, 20, 10);
                scene.add(directionalLight);
    
                const directionalLight2 = new THREE.DirectionalLight(0xffffff, 0.4);
                directionalLight2.position.set(-10, -10, -10);
                scene.add(directionalLight2);
    
                // Grid
                const gridHelper = new THREE.GridHelper(100, 20, 0x444444, 0x222222);
                scene.add(gridHelper);
    
                // Axes
                const axesHelper = new THREE.AxesHelper(30);
                scene.add(axesHelper);
    
                // Create aircraft
                createAircraft();
    
                // Mouse event listeners
                canvas.addEventListener('mousemove', onMouseMove, false);
                canvas.addEventListener('click', onMouseClick, false);
    
                // Animation loop
                animate();
            }
    
            function createAircraft() {
                const group = new THREE.Group();
    
                // Fuselage - centered at origin
                const fuselageLength = AIRCRAFT.length;
                const fuselageRadius = AIRCRAFT.diameter / 2;
                const fuselageGeometry = new THREE.CylinderGeometry(
                    fuselageRadius,
                    fuselageRadius,
                    fuselageLength,
                    32
                );
                const fuselageMaterial = new THREE.MeshPhongMaterial({
                    color: 0xcccccc,
                    transparent: true,
                    opacity: 0.3,
                    side: THREE.DoubleSide
                });
                fuselage = new THREE.Mesh(fuselageGeometry, fuselageMaterial);
                fuselage.rotation.z = Math.PI / 2; // Rotate to align with X axis
                group.add(fuselage);
                interactiveObjects.push(fuselage);
    
                // Nose cone - pointing FORWARD (+X direction)
                const noseGeometry = new THREE.ConeGeometry(fuselageRadius, 4, 32);
                const noseMaterial = new THREE.MeshPhongMaterial({
                    color: 0xaaaaaa,
                    transparent: true,
                    opacity: 0.3
                });
                const nose = new THREE.Mesh(noseGeometry, noseMaterial);
                nose.rotation.z = -Math.PI / 2; // Point cone forward (positive X)
                nose.position.x = fuselageLength / 2 + 2; // Position at front
                group.add(nose);
                interactiveObjects.push(nose);
    
                // Tail cone
                const tailGeometry = new THREE.ConeGeometry(fuselageRadius, 5, 32);
                const tailMaterial = new THREE.MeshPhongMaterial({
                    color: 0xaaaaaa,
                    transparent: true,
                    opacity: 0.3
                });
                const tailCone = new THREE.Mesh(tailGeometry, tailMaterial);
                tailCone.rotation.z = Math.PI / 2; // Point backward
                tailCone.position.x = -fuselageLength / 2 - 2.5;
                group.add(tailCone);
                interactiveObjects.push(tailCone);
    
                // Wings - HORIZONTAL extending from SIDES
                const wingGeometry = new THREE.BoxGeometry(8, 0.3, AIRCRAFT.wingspan);
                const wingMaterial = new THREE.MeshPhongMaterial({
                    color: 0x888888,
                    transparent: true,
                    opacity: 0.7
                });
                wings = new THREE.Mesh(wingGeometry, wingMaterial);
                wings.position.x = staToX(700); // Position at wing center section
                wings.position.y = -fuselageRadius * 0.3; // Below fuselage centerline
                group.add(wings);
                interactiveObjects.push(wings);
    
                // Horizontal Stabilizer
                const hStabGeometry = new THREE.BoxGeometry(4, 0.2, 12);
                const hStabMaterial = new THREE.MeshPhongMaterial({
                    color: 0x888888,
                    transparent: true,
                    opacity: 0.7
                });
                const hStab = new THREE.Mesh(hStabGeometry, hStabMaterial);
                hStab.position.x = -fuselageLength / 2 - 3;
                hStab.position.y = fuselageRadius * 0.5;
                group.add(hStab);
                interactiveObjects.push(hStab);
    
                // Vertical Stabilizer
                const vStabGeometry = new THREE.BoxGeometry(4, 6, 0.2);
                const vStabMaterial = new THREE.MeshPhongMaterial({
                    color: 0x888888,
                    transparent: true,
                    opacity: 0.7
                });
                tail = new THREE.Mesh(vStabGeometry, vStabMaterial);
                tail.position.x = -fuselageLength / 2 - 3;
                tail.position.y = fuselageRadius + 3;
                group.add(tail);
                interactiveObjects.push(tail);
    
                // Forward Entry Door (STA 312-344, above WL 208.54)
                const doorWidth = staToX(344) - staToX(312);
                const doorHeight = 1.8; // Approximate door height in meters
                const doorGeometry = new THREE.BoxGeometry(doorWidth, doorHeight, 0.1);
                const doorMaterial = new THREE.MeshPhongMaterial({
                    color: 0xff6600,
                    transparent: true,
                    opacity: 0.8
                });
                const door = new THREE.Mesh(doorGeometry, doorMaterial);
                door.position.x = (staToX(312) + staToX(344)) / 2;
                door.position.y = wlToY(208.54) + doorHeight / 2;
                door.position.z = fuselageRadius + 0.05; // Right side (positive Z)
                group.add(door);
    
                // Door label
                const doorLabel = createTextLabel('Entry Door
STA 312-344');
                doorLabel.position.copy(door.position);
                doorLabel.position.z += 1;
                group.add(doorLabel);
    
                // Electronics Compartment (STA 323.7-351.2, bottom of fuselage)
                const elecWidth = staToX(351.2) - staToX(323.7);
                const elecHeight = 0.8;
                const elecGeometry = new THREE.BoxGeometry(elecWidth, elecHeight, 2);
                const elecMaterial = new THREE.MeshPhongMaterial({
                    color: 0x0066ff,
                    wireframe: true,
                    transparent: true,
                    opacity: 0.6
                });
                const elecBay = new THREE.Mesh(elecGeometry, elecMaterial);
                elecBay.position.x = (staToX(323.7) + staToX(351.2)) / 2;
                elecBay.position.y = -fuselageRadius - elecHeight / 2;
                group.add(elecBay);
    
                // Electronics label
                const elecLabel = createTextLabel('Electronics Bay
STA 323.7-351.2');
                elecLabel.position.copy(elecBay.position);
                elecLabel.position.y -= 1.5;
                group.add(elecLabel);
    
                scene.add(group);
            }
    
            function createTextLabel(text) {
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                canvas.width = 512;
                canvas.height = 256;
                
                context.fillStyle = 'rgba(0, 0, 0, 0.7)';
                context.fillRect(0, 0, canvas.width, canvas.height);
                
                context.font = 'Bold 36px Arial';
                context.fillStyle = 'white';
                context.textAlign = 'center';
                context.textBaseline = 'middle';
                
                const lines = text.split('
');
                lines.forEach((line, i) => {
                    context.fillText(line, canvas.width / 2, canvas.height / 2 + (i - 0.5) * 40);
                });
                
                const texture = new THREE.CanvasTexture(canvas);
                const material = new THREE.SpriteMaterial({ map: texture });
                const sprite = new THREE.Sprite(material);
                sprite.scale.set(4, 2, 1);
                
                return sprite;
            }
    
            function staToX(sta) {
                // Convert station to X coordinate
                // STA 130 = front (+X), STA 1217 = rear (-X)
                const normalized = (sta - AIRCRAFT.staMin) / (AIRCRAFT.staMax - AIRCRAFT.staMin);
                return (0.5 - normalized) * AIRCRAFT.length;
            }
    
            function xToSta(x) {
                // Convert X coordinate back to station
                const normalized = 0.5 - (x / AIRCRAFT.length);
                return AIRCRAFT.staMin + normalized * (AIRCRAFT.staMax - AIRCRAFT.staMin);
            }
    
            function wlToY(wl) {
                // Convert waterline to Y coordinate
                // Assume WL 0 at bottom, WL 308.5 at top
                const wlMin = 0;
                const wlMax = 308.5;
                return ((wl - wlMin) / (wlMax - wlMin)) * AIRCRAFT.diameter * 2 - AIRCRAFT.diameter;
            }
    
            function yToWl(y) {
                // Convert Y coordinate back to waterline
                const wlMin = 0;
                const wlMax = 308.5;
                return ((y + AIRCRAFT.diameter) / (AIRCRAFT.diameter * 2)) * (wlMax - wlMin) + wlMin;
            }
    
            function blToZ(bl, side) {
                // Convert buttock line to Z coordinate
                // BL 0 = centerline, positive values for both RBL and LBL
                // RBL = positive Z, LBL = negative Z
                const blMax = 64;
                const zValue = (bl / blMax) * (AIRCRAFT.diameter / 2);
                return side === 'R' ? zValue : -zValue;
            }
    
            function zToBl(z) {
                // Convert Z coordinate back to buttock line
                const blMax = 64;
                const bl = (Math.abs(z) / (AIRCRAFT.diameter / 2)) * blMax;
                const side = z >= 0 ? 'RBL' : 'LBL';
                return { bl: bl, side: side };
            }
    
            function plotCoordinate() {
                const sta = parseFloat(document.getElementById('station').value);
                const wl = parseFloat(document.getElementById('waterline').value);
                const bl = parseFloat(document.getElementById('buttockline').value);
                const blSide = document.getElementById('blSide').value;
    
                if (isNaN(sta) || isNaN(wl) || isNaN(bl)) {
                    alert('Please enter valid numeric coordinates');
                    return;
                }
    
                // Remove old marker
                if (marker) {
                    scene.remove(marker);
                }
    
                // Create new marker
                const markerGeometry = new THREE.SphereGeometry(0.3, 32, 32);
                const markerMaterial = new THREE.MeshPhongMaterial({
                    color: 0xff0000,
                    emissive: 0xff0000,
                    emissiveIntensity: 0.5
                });
                marker = new THREE.Mesh(markerGeometry, markerMaterial);
    
                // Position marker
                marker.position.x = staToX(sta);
                marker.position.y = wlToY(wl);
                marker.position.z = blToZ(bl, blSide);
    
                scene.add(marker);
    
                // Animate marker
                animateMarker();
            }
    
            function animateMarker() {
                if (!marker) return;
                
                let scale = 1;
                let growing = true;
                
                function pulse() {
                    if (!marker) return;
                    
                    if (growing) {
                        scale += 0.02;
                        if (scale >= 1.3) growing = false;
                    } else {
                        scale -= 0.02;
                        if (scale <= 1) growing = true;
                    }
                    
                    marker.scale.set(scale, scale, scale);
                    requestAnimationFrame(pulse);
                }
                
                pulse();
            }
    
            function onMouseMove(event) {
                const canvas = document.getElementById('viewer3d');
                const rect = canvas.getBoundingClientRect();
                
                mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
                mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
    
                raycaster.setFromCamera(mouse, camera);
                const intersects = raycaster.intersectObjects(interactiveObjects, false);
    
                const coordDisplay = document.getElementById('coordDisplay');
                
                if (intersects.length > 0) {
                    const point = intersects[0].point;
                    const sta = xToSta(point.x);
                    const wl = yToWl(point.y);
                    const blInfo = zToBl(point.z);
    
                    document.getElementById('hoverSta').textContent = sta.toFixed(1);
                    document.getElementById('hoverWl').textContent = wl.toFixed(1);
                    document.getElementById('hoverBl').textContent = `${blInfo.side} ${blInfo.bl.toFixed(1)}`;
                    
                    coordDisplay.classList.add('active');
                    canvas.style.cursor = 'pointer';
                } else {
                    coordDisplay.classList.remove('active');
                    canvas.style.cursor = 'default';
                }
            }
    
            function onMouseClick(event) {
                const canvas = document.getElementById('viewer3d');
                const rect = canvas.getBoundingClientRect();
                
                mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
                mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
    
                raycaster.setFromCamera(mouse, camera);
                const intersects = raycaster.intersectObjects(interactiveObjects, false);
    
                if (intersects.length > 0) {
                    const point = intersects[0].point;
                    const sta = xToSta(point.x);
                    const wl = yToWl(point.y);
                    const blInfo = zToBl(point.z);
    
                    // Update input fields
                    document.getElementById('station').value = sta.toFixed(1);
                    document.getElementById('waterline').value = wl.toFixed(1);
                    document.getElementById('buttockline').value = blInfo.bl.toFixed(1);
                    document.getElementById('blSide').value = blInfo.side === 'RBL' ? 'R' : 'L';
    
                    // Plot the coordinate
                    plotCoordinate();
                }
            }
    
            function toggleTransparency() {
                isTransparent = !isTransparent;
                const opacity = isTransparent ? 0.3 : 0.8;
                
                if (fuselage) fuselage.material.opacity = opacity;
                scene.traverse((child) => {
                    if (child.isMesh && child.material.transparent) {
                        child.material.opacity = opacity;
                    }
                });
            }
    
            function toggleWireframe() {
                isWireframe = !isWireframe;
                
                scene.traverse((child) => {
                    if (child.isMesh && child !== marker) {
                        child.material.wireframe = isWireframe;
                    }
                });
            }
    
            function resetCamera() {
                camera.position.set(50, 30, 50);
                camera.lookAt(0, 0, 0);
            }
    
            function animate() {
                requestAnimationFrame(animate);
                
                // Simple rotation control with mouse drag
                if (mouseDown) {
                    camera.position.x = 50 * Math.cos(rotationY) * Math.cos(rotationX);
                    camera.position.y = 50 * Math.sin(rotationX);
                    camera.position.z = 50 * Math.sin(rotationY) * Math.cos(rotationX);
                    camera.lookAt(0, 0, 0);
                }
                
                renderer.render(scene, camera);
            }
    
            // Simple mouse rotation
            let mouseDown = false;
            let rotationX = 0.5;
            let rotationY = 0.8;
            let lastMouseX = 0;
            let lastMouseY = 0;
    
            document.getElementById('viewer3d').addEventListener('mousedown', (e) => {
                mouseDown = true;
                lastMouseX = e.clientX;
                lastMouseY = e.clientY;
            });
    
            document.addEventListener('mouseup', () => {
                mouseDown = false;
            });
    
            document.addEventListener('mousemove', (e) => {
                if (mouseDown) {
                    const deltaX = e.clientX - lastMouseX;
                    const deltaY = e.clientY - lastMouseY;
                    
                    rotationY += deltaX * 0.01;
                    rotationX += deltaY * 0.01;
                    
                    // Limit vertical rotation
                    rotationX = Math.max(-Math.PI / 2, Math.min(Math.PI / 2, rotationX));
                    
                    lastMouseX = e.clientX;
                    lastMouseY = e.clientY;
                }
            });
    
            // Handle window resize
            window.addEventListener('resize', () => {
                const canvas = document.getElementById('viewer3d');
                camera.aspect = canvas.clientWidth / canvas.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(canvas.clientWidth, canvas.clientHeight);
            });
    
            // Initialize on load
            init();
        </script>
    </body>
    </html>